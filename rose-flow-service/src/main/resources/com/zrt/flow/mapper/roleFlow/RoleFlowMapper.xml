<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.zrt.flow.mapper.roleFlow.RoleFlowMapper">
	
	<!--获取流程列表-->
	<select id="roleFlowList" resultType="java.util.HashMap">
       	SELECT 
		  DISTINCT
		  tt.t_code,
		  tt.t_name,
		  t1.id t_type_id,
		  t1.t_name t_type_name,
		  t2.id parent_t_type_id,
		  t2.t_name parent_t_type_name ,
		  t1.id as parent_id
		  
		FROM
		  fb_bus_user_role fbur 
		  JOIN fb_role_template frt 
		    ON fbur.role_id = frt.role_id 
		  JOIN fb_bus_template tt 
		    ON frt.t_code = tt.t_code 
		  JOIN fb_bus_type t1 
		    ON tt.f_b_t_id = t1.id 
		  JOIN fb_bus_type t2 
		    ON tt.parent_id = t2.id 
		WHERE tt.t_enabled = '2' 
		  AND fbur.emp_id = #{emp_id}
	</select>
	
	<select id="flowList" resultType="java.util.HashMap">
       	SELECT 
		  tt.t_code,
		  tt.t_name,
		  t1.id t_type_id,
		  t1.t_name t_type_name,
		  t2.id parent_t_type_id,
		  t2.t_name parent_t_type_name,
		  t1.id as parent_id
		
		FROM
		  fb_bus_template tt 
		  JOIN fb_bus_type t1 
		    ON tt.f_b_t_id = t1.id 
		  JOIN fb_bus_type t2 
		    ON tt.parent_id = t2.id 
		WHERE tt.t_enabled = '2' 
	</select>
  	
</mapper>