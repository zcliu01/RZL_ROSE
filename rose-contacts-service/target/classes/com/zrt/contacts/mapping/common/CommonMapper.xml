<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.zrt.contacts.mapping.common" >
  <sql id="moreConditionForFriendEmp">
    <!-- <if test="mapParam.emp_id != null and mapParam.emp_id!='' ">
      AND sse.emp_id = #{mapParam.emp_id}
    </if> -->
    AND sse.emp_active = "1" AND sse.emp_enabled ="1"
    <if test="mapParam.emp_name != null and mapParam.emp_name !=''">
      AND sse.emp_name LIKE CONCAT('%',#{mapParam.emp_name},'%')
    </if>
    <if test="mapParam.emp_code != null and mapParam.emp_code !=''">
      AND sse.emp_code LIKE CONCAT('%',#{mapParam.emp_code},'%')
    </if>
    <if test="mapParam.join_start_time != null and mapParam.join_start_time !=''">
      <![CDATA[and sse.entry_time >= #{mapParam.join_start_time}]]>
    </if>
    <if test="mapParam.join_end_time != null and mapParam.join_end_time !=''">
      <![CDATA[and sse.entry_time <= #{mapParam.join_end_time}]]>
    </if>
    <if test="mapParam.f_join_start_time != null and mapParam.f_join_start_time !=''">
      <![CDATA[and sse.create_date_time >= #{mapParam.f_join_start_time}]]>
    </if>
    <if test="mapParam.f_join_end_time != null and mapParam.f_join_end_time !=''">
      <![CDATA[and sse.create_date_time <= #{mapParam.f_join_end_time}]]>
    </if>
    <if test="mapParam.org_name != null and mapParam.org_name !=''">
      AND sso.org_name_view LIKE CONCAT('%',#{mapParam.org_name},'%')
    </if>
    <if test="mapParam.emp_position_name != null and mapParam.emp_position_name !=''">
      AND psp.p_name LIKE CONCAT('%',#{mapParam.emp_position_name},'%')
    </if>
    <if test="mapParam.emp_no != null and mapParam.emp_no !=''">
      AND (sse.emp_phone LIKE CONCAT('%',#{mapParam.emp_no},'%') or sse.emp_mobile_phone LIKE CONCAT('%',#{mapParam.emp_no},'%'))
    </if>
    <if test="mapParam.emp_sex != null and mapParam.emp_sex !=''">
      AND sse.emp_sex = #{mapParam.emp_sex}
    </if>
    <if test="mapParam.emp_email != null and mapParam.emp_email !=''">
      AND sse.emp_email LIKE CONCAT('%',#{mapParam.emp_email},'%')
    </if>
    <if test="mapParam.emp_work_address != null and mapParam.emp_work_address!=''">
      AND sse.emp_work_address LIKE CONCAT('%',#{mapParam.emp_work_address},'%')
    </if>
     <!-- <if test="mapParam.emp_active!= null and mapParam.emp_active!=''">
      AND sse.emp_active = #{mapParam.emp_active}
    </if>
     <if test="mapParam.emp_enabled != null and mapParam.emp_enabled!=''">
      AND sse.emp_enabled =#{mapParam.emp_enabled}
    </if> -->
    <!-- pc端添加搜索条件查询 常用联系人 列表 -->
     <if test="mapParam.search != null and mapParam.search !=''">
      AND (sse.emp_name  LIKE CONCAT('%',#{mapParam.emp_name},'%') 
      OR sse.emp_code LIKE CONCAT('%',#{mapParam.emp_code},'%') 
      OR sso.org_name_view LIKE CONCAT('%',#{mapParam.org_name},'%') 
      )
    </if>
  </sql>

<!-- 用于检索条件 -->
  <sql id="moreSearchWhere">
   <if test="map.search!= null and map.search !=''">
		AND (sse.emp_name LIKE CONCAT('%',#{map.search},'%')
		OR sse.emp_code LIKE CONCAT('%',#{map.search},'%')  
		OR sso.org_name_view LIKE CONCAT('%',#{map.search},'%') 
	    OR sse.emp_py LIKE CONCAT('',#{map.search},'%') 
	    OR sse.emp_sl LIKE CONCAT('',#{map.search},'%')
	    OR sse.emp_mobile_phone LIKE CONCAT('',#{map.search},'%')
	    OR sse.emp_phone LIKE CONCAT('',#{map.search},'%')
	    ) 
   </if> 
 </sql> 

 <sql id="moreMateWhere">
    <choose>
       <when test="mapParam.searchArr != null ">
        <foreach collection="mapParam.searchArr" item="search1" open="AND (" close=")" separator="or">
            ( sse.emp_id = #{search1}
          or  sse.emp_name LIKE CONCAT('%',#{search1},'%')
          or sse.emp_code LIKE CONCAT('%',#{search1},'%')
          or sse.emp_sl LIKE CONCAT('',#{search1},'%')
          or LOWER(sse.emp_py) LIKE CONCAT('',#{search1},'%')
          or sso.org_name_view LIKE CONCAT('%',#{search1},'%')
          or sse.emp_mobile_phone LIKE CONCAT(#{search1},'%')
          ) 
        </foreach>
      </when>
      <when test="mapParam.searchArr == null " >
        <if test="mapParam.search != null and mapParam.search != ''" >
          AND (
             sse.emp_id = #{mapParam.search}
          OR sse.emp_name LIKE CONCAT('%',#{mapParam.search},'%')
          OR sse.emp_code LIKE CONCAT('%',#{mapParam.search},'%')
          OR sse.emp_sl LIKE CONCAT('',#{mapParam.search},'%')
          OR sse.emp_py LIKE CONCAT('',#{mapParam.search},'%')
          OR sse.emp_phone LIKE CONCAT('%',#{mapParam.search},'%')
          OR sse.emp_mobile_phone LIKE CONCAT('%',#{mapParam.search},'%')
          OR sse.emp_email LIKE CONCAT('%',#{mapParam.search},'%')
          OR sso.org_name_view LIKE CONCAT('%',#{mapParam.search},'%')
          )
        </if>
      </when>
    </choose>
  </sql>
  
</mapper>